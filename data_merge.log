2025-11-08 14:40:12 — INFO — ===== Starting Data Integration Process =====
2025-11-08 14:40:12 — INFO — \u2705 All CSV files loaded successfully.
2025-11-08 14:40:12 — ERROR — \u274c Error processing DateOfAdmission: 'DateOfAdmission'
Traceback (most recent call last):
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateOfAdmission'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\Patientsatisfctrymodel\mergetest.py", line 46, in <module>
    patients['DateOfAdmission'] = pd.to_datetime(patients['DateOfAdmission'])
                                                 ~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'DateOfAdmission'
2025-11-08 14:41:01 — INFO — ===== Starting Data Integration Process =====
2025-11-08 14:41:01 — INFO — \u2705 All CSV files loaded successfully.
2025-11-08 14:41:01 — INFO — \u2705 Converted DateOfAdmission to datetime and engineered Week column.
2025-11-08 14:41:01 — ERROR — \u274c Error merging patients and services: 'Week'
Traceback (most recent call last):
  File "C:\Users\user\Desktop\Patientsatisfctrymodel\mergetest.py", line 59, in <module>
    merged = pd.merge(
        patients,
    ...<2 lines>...
        how="left"
    )
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\reshape\merge.py", line 170, in merge
    op = _MergeOperation(
        left_df,
    ...<10 lines>...
        validate=validate,
    )
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\reshape\merge.py", line 794, in __init__
    ) = self._get_merge_keys()
        ~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\reshape\merge.py", line 1297, in _get_merge_keys
    right_keys.append(right._get_label_or_level_values(rk))
                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'Week'
2025-11-08 14:42:29 — INFO — ===== Starting Data Integration Process =====
2025-11-08 14:42:29 — INFO — \u2705 All CSV files loaded successfully.
2025-11-08 14:42:29 — INFO — \u2705 Converted dates and engineered 'week' column in patients data.
2025-11-08 14:42:29 — ERROR — \u274c Error merging patients and services: You are trying to merge on object and int64 columns for key 'week'. If you wish to proceed you should use pd.concat
Traceback (most recent call last):
  File "C:\Users\user\Desktop\Patientsatisfctrymodel\mergetest.py", line 56, in <module>
    merged = pd.merge(
        patients,
    ...<2 lines>...
        how="left"  # Keep all patient records
    )
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\reshape\merge.py", line 170, in merge
    op = _MergeOperation(
        left_df,
    ...<10 lines>...
        validate=validate,
    )
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\reshape\merge.py", line 807, in __init__
    self._maybe_coerce_merge_keys()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\reshape\merge.py", line 1508, in _maybe_coerce_merge_keys
    raise ValueError(msg)
ValueError: You are trying to merge on object and int64 columns for key 'week'. If you wish to proceed you should use pd.concat
2025-11-08 14:43:20 — INFO — ===== Starting Data Integration Process =====
2025-11-08 14:43:20 — INFO — \u2705 All CSV files loaded successfully.
2025-11-08 14:43:20 — INFO — \u2705 Converted dates and engineered 'week' column in patients data.
2025-11-08 14:43:20 — ERROR — \u274c Error merging patients and services: You are trying to merge on object and int64 columns for key 'week'. If you wish to proceed you should use pd.concat
Traceback (most recent call last):
  File "C:\Users\user\Desktop\Patientsatisfctrymodel\mergetest.py", line 56, in <module>
    merged = pd.merge(
        patients,
    ...<2 lines>...
        how="left"  # Keep all patient records
    )
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\reshape\merge.py", line 170, in merge
    op = _MergeOperation(
        left_df,
    ...<10 lines>...
        validate=validate,
    )
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\reshape\merge.py", line 807, in __init__
    self._maybe_coerce_merge_keys()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\reshape\merge.py", line 1508, in _maybe_coerce_merge_keys
    raise ValueError(msg)
ValueError: You are trying to merge on object and int64 columns for key 'week'. If you wish to proceed you should use pd.concat
2025-11-08 14:43:28 — INFO — ===== Starting Data Integration Process =====
2025-11-08 14:43:28 — INFO — \u2705 All CSV files loaded successfully.
2025-11-08 14:43:28 — INFO — \u2705 Converted dates and ensured 'week' columns are numeric in both datasets.
2025-11-08 14:43:28 — INFO — \u2705 Merged patients + services successfully. Shape: (1000, 16)
2025-11-08 14:43:28 — INFO — \u2705 Staff and schedule merged. Shape: (0, 9)
2025-11-08 14:43:28 — ERROR — \u274c Error computing ActualStaffPresent: Can only use .str accessor with string values!
Traceback (most recent call last):
  File "C:\Users\user\Desktop\Patientsatisfctrymodel\mergetest.py", line 81, in <module>
    staff_present = staff_merged[staff_merged['present'].str.lower() == 'present']
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\accessor.py", line 224, in __get__
    accessor_obj = self._accessor(obj)
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\strings\accessor.py", line 194, in __init__
    self._inferred_dtype = self._validate(data)
                           ~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\strings\accessor.py", line 248, in _validate
    raise AttributeError("Can only use .str accessor with string values!")
AttributeError: Can only use .str accessor with string values!. Did you mean: 'std'?
2025-11-08 14:44:05 — INFO — ===== Starting Data Integration Process =====
2025-11-08 14:44:06 — INFO — \u2705 All CSV files loaded successfully.
2025-11-08 14:44:06 — INFO — \u2705 Converted dates and ensured 'week' columns are numeric in both datasets.
2025-11-08 14:44:06 — INFO — \u2705 Merged patients + services successfully. Shape: (1000, 16)
2025-11-08 14:44:06 — INFO — \u2705 Staff and schedule merged. Shape: (0, 9)
2025-11-08 14:44:06 — INFO — \u2705 Filtered 'Present' staff. Remaining rows: 0
2025-11-08 14:44:06 — ERROR — \u274c Error computing ActualStaffPresent: 'service'
Traceback (most recent call last):
  File "C:\Users\user\Desktop\Patientsatisfctrymodel\mergetest.py", line 90, in <module>
    staff_present.groupby(['service', 'week'])
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\frame.py", line 9190, in groupby
    return DataFrameGroupBy(
        obj=self,
    ...<7 lines>...
        dropna=dropna,
    )
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\groupby\groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
                               ~~~~~~~~~~~^
        obj,
        ^^^^
    ...<5 lines>...
        dropna=self.dropna,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\user\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\groupby\grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'service'
